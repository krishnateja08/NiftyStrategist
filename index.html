<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>NIFTY Indian Markets HUB â€” Intelligence Hub</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Rajdhani:wght@400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}

:root{
  --bg:#02000a;--panel:#06040f;--p2:#0b0818;
  --cyan:#00f5ff;--pink:#ff0090;--yel:#ffe000;
  --grn:#00ff88;--pur:#9d00ff;--red:#ff2255;
  --bc:rgba(0,245,255,.12);--bp:rgba(255,0,144,.12);
  --b1:rgba(0,245,255,.07);--b2:rgba(0,245,255,.14);
  --tx:rgba(220,240,255,.97);--t2:rgba(0,245,255,.75);--t3:rgba(0,245,255,.45);
}

body{background:var(--bg);color:var(--tx);font-family:'Rajdhani',sans-serif;font-weight:500;overflow-x:hidden;min-height:100vh;}

body::before{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background:linear-gradient(rgba(0,245,255,.028) 1px,transparent 1px),linear-gradient(90deg,rgba(0,245,255,.028) 1px,transparent 1px);
  background-size:48px 48px;}
body::after{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background:radial-gradient(ellipse 55% 45% at 5% 50%,rgba(0,245,255,.055) 0%,transparent 65%),
    radial-gradient(ellipse 45% 55% at 95% 50%,rgba(255,0,144,.055) 0%,transparent 65%),
    radial-gradient(ellipse 35% 25% at 50% 100%,rgba(157,0,255,.06) 0%,transparent 60%);}
#scan{position:fixed;inset:0;z-index:998;pointer-events:none;
  background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,.06) 2px,rgba(0,0,0,.06) 4px);}

#app{position:relative;z-index:1;min-height:100vh;display:flex;flex-direction:column}

/* â•â• TOPBAR â•â• */
.tb{background:rgba(0,0,0,.85);border-bottom:1px solid var(--cyan);padding:4px 18px;
  display:flex;justify-content:space-between;align-items:center;
  font-family:'Orbitron',monospace;font-size:9px;letter-spacing:2px;
  position:relative;z-index:10;box-shadow:0 0 20px rgba(0,245,255,.1);}
.tb-l{color:var(--cyan);font-weight:600}
.tb-r{display:flex;gap:16px;color:var(--t3)}
.tb-r .v{color:var(--t2)}.tb-r .live{color:var(--grn)}

.dot{display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--grn);
  box-shadow:0 0 8px var(--grn);animation:blink 1.4s ease-in-out infinite;
  margin-right:5px;vertical-align:middle;}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.08}}

/* â•â• HEADER â•â• */
header{background:rgba(6,4,15,.95);border-bottom:1px solid var(--bc);padding:13px 18px;
  display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
  position:sticky;top:0;z-index:90;backdrop-filter:blur(12px);
  box-shadow:0 1px 0 rgba(0,245,255,.2),0 4px 20px rgba(0,0,0,.6);}
header::after{content:'';position:absolute;bottom:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,var(--cyan),var(--pink),var(--cyan),transparent);opacity:.6;}

.brand{display:flex;align-items:center;gap:14px}
.logo{width:50px;height:50px;flex-shrink:0;
  clip-path:polygon(50% 0%,95% 25%,95% 75%,50% 100%,5% 75%,5% 25%);
  background:linear-gradient(135deg,rgba(0,245,255,.18),rgba(255,0,144,.12));
  border:1px solid var(--cyan);display:flex;align-items:center;justify-content:center;font-size:22px;
  box-shadow:0 0 22px rgba(0,245,255,.35),inset 0 0 14px rgba(0,245,255,.06);
  animation:hexglow 3s ease-in-out infinite;}
@keyframes hexglow{
  0%,100%{box-shadow:0 0 22px rgba(0,245,255,.35),inset 0 0 14px rgba(0,245,255,.06)}
  50%{box-shadow:0 0 40px rgba(0,245,255,.6),inset 0 0 20px rgba(0,245,255,.12)}}
.bname{font-family:'Orbitron',sans-serif;font-size:16px;font-weight:700;letter-spacing:2px;
  color:var(--cyan);text-shadow:0 0 20px rgba(0,245,255,.5),0 0 40px rgba(0,245,255,.2);}
.bname span{color:var(--pink);text-shadow:0 0 20px rgba(255,0,144,.5)}
.bsub{font-size:9px;color:var(--t3);letter-spacing:3px;margin-top:4px;font-family:'Orbitron',sans-serif}
.hright{display:flex;gap:8px;flex-wrap:wrap}
.pill{padding:5px 12px;font-size:9px;letter-spacing:2px;font-family:'Orbitron',sans-serif;
  text-transform:uppercase;border:1px solid var(--bc);color:var(--t2);background:rgba(0,245,255,.03);
  clip-path:polygon(6px 0%,100% 0%,calc(100% - 6px) 100%,0% 100%);}
.pill.g{border-color:rgba(0,255,136,.3);color:var(--grn);background:rgba(0,255,136,.04)}
.pill.p{border-color:rgba(255,0,144,.3);color:var(--pink);background:rgba(255,0,144,.04)}

/* â•â• MARKET BAR â•â• */
.mbar{
  display:grid;
  grid-template-columns:38px 1fr 38px 1fr;
  background:rgba(0,0,0,.82);
  border-bottom:1px solid rgba(0,245,255,.12);
  position:relative;z-index:5;
  overflow:hidden;
}
.mbar::after{content:'';position:absolute;bottom:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,var(--cyan),var(--pink),var(--yel),var(--pur),var(--cyan));opacity:.35;}

.mbar-label{
  display:flex;align-items:center;justify-content:center;flex-direction:column;
  gap:4px;padding:6px 4px;flex-shrink:0;
}
.mbar-label.india{
  background:linear-gradient(180deg,rgba(0,245,255,.06),rgba(0,245,255,.02));
  border-right:1px solid rgba(0,245,255,.12);
}
.mbar-label.global{
  background:linear-gradient(180deg,rgba(255,224,0,.05),rgba(255,224,0,.01));
  border-right:1px solid rgba(255,224,0,.12);
  border-left:1px solid rgba(0,245,255,.08);
}
.mbar-label-flag{font-size:12px;line-height:1;}
.mbar-label-txt{
  writing-mode:vertical-rl;text-orientation:mixed;transform:rotate(180deg);
  font-family:'Orbitron',monospace;font-size:6px;letter-spacing:2px;
}
.mbar-label.india .mbar-label-txt{color:var(--cyan);}
.mbar-label.global .mbar-label-txt{color:var(--yel);}

.mbar-items{display:flex;overflow-x:auto;scrollbar-width:none;align-items:stretch;}
.mbar-items::-webkit-scrollbar{display:none;}

.mbar-item{
  display:flex;flex-direction:column;justify-content:center;
  padding:7px 16px 6px;
  border-right:1px solid rgba(0,245,255,.06);
  flex-shrink:0;min-width:110px;position:relative;
  transition:background .2s;
}
.mbar-item:hover{background:rgba(0,245,255,.03);}
.mbar-item:last-child{border-right:none;}

.mbar-item::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:var(--ic,rgba(0,245,255,.3));opacity:.4;}

.mbar-name{
  font-family:'Orbitron',monospace;font-size:7px;letter-spacing:1.5px;
  color:var(--t3);margin-bottom:3px;white-space:nowrap;
}
.mbar-val{
  font-family:'Share Tech Mono',monospace;font-size:15px;font-weight:700;
  color:var(--ic,var(--tx));
  text-shadow:0 0 8px var(--is,rgba(0,245,255,.3));
  line-height:1;white-space:nowrap;
  transition:color .3s;
}
.mbar-chg{
  font-family:'Share Tech Mono',monospace;font-size:10px;
  margin-top:3px;white-space:nowrap;display:flex;align-items:center;gap:4px;
}
.mbar-chg.up{color:var(--grn);}
.mbar-chg.dn{color:var(--red);}
.mbar-chg.vix{color:var(--yel);}

.mbar-item.is-vix .mbar-val{color:var(--yel);text-shadow:0 0 8px rgba(255,224,0,.35);}

@keyframes val-flash{0%{opacity:.4}50%{opacity:1}100%{opacity:1}}
.val-updated{animation:val-flash .5s ease;}

/* Data source indicator */
.mbar-src{
  position:absolute;bottom:2px;left:8px;
  font-family:'Orbitron',monospace;font-size:5px;letter-spacing:1px;
  opacity:.25;
}
.mbar-src.nse{color:var(--cyan);}
.mbar-src.yf{color:var(--yel);}
.mbar-src.err{color:var(--red);}

.mbar-updated{
  position:absolute;bottom:2px;right:6px;
  font-family:'Orbitron',monospace;font-size:6px;letter-spacing:1px;color:rgba(0,245,255,.2);
}

/* â•â• TICKER â•â• */
.tkr{background:rgba(0,0,0,.7);border-bottom:1px solid var(--b1);
  padding:5px 0;overflow:hidden;white-space:nowrap;position:relative;}
.tkr::before,.tkr::after{content:'';position:absolute;top:0;bottom:0;width:70px;z-index:2;pointer-events:none;}
.tkr::before{left:0;background:linear-gradient(90deg,var(--bg),transparent)}
.tkr::after{right:0;background:linear-gradient(-90deg,var(--bg),transparent)}
.tkr-t{display:inline-flex;animation:tscroll 32s linear infinite}
@keyframes tscroll{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.ti{display:inline-flex;align-items:center;gap:9px;padding:0 20px;font-size:11px;
  font-family:'Orbitron',monospace;border-right:1px solid rgba(0,245,255,.08);}
.ti .s{color:var(--cyan);font-size:9px;letter-spacing:1.5px;font-weight:600}
.up{color:var(--grn)}.dn{color:var(--red)}

/* â•â• STATS BAR â•â• */
.stats{display:grid;grid-template-columns:repeat(4,1fr);background:rgba(0,245,255,.06);gap:1px;border-bottom:1px solid var(--bc);}
.sb{background:var(--panel);padding:11px 16px;position:relative;overflow:hidden;}
.sb::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--sc,var(--cyan));box-shadow:0 0 8px var(--sc,var(--cyan));}
.sb::after{content:var(--sg,'â—ˆ');position:absolute;bottom:-6px;right:8px;font-size:40px;color:rgba(0,245,255,.04);pointer-events:none;line-height:1;font-family:'Orbitron',sans-serif;}
.sb .l{font-family:'Orbitron',sans-serif;font-size:8px;color:var(--t3);letter-spacing:2.5px;text-transform:uppercase;margin-bottom:5px;}
.sb .v{font-family:'Orbitron',sans-serif;font-size:16px;font-weight:700;color:var(--sc,var(--cyan));text-shadow:0 0 12px currentColor;}
.sb .s{font-size:10px;color:var(--t2);margin-top:3px}

/* â•â• SECTION â•â• */
.sec{padding:11px 18px 9px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--b1);}
.sec-bar{width:3px;height:13px;background:var(--cyan);box-shadow:0 0 8px var(--cyan);flex-shrink:0}
.sec-txt{font-family:'Orbitron',sans-serif;font-size:9px;color:var(--cyan);letter-spacing:3px;text-transform:uppercase;font-weight:600;text-shadow:0 0 10px rgba(0,245,255,.4);}
.sec-bdg{margin-left:auto;font-family:'Orbitron',sans-serif;font-size:8px;color:var(--pink);border:1px solid rgba(255,0,144,.3);padding:2px 10px;letter-spacing:2px;background:rgba(255,0,144,.05);}

/* â•â• GROUPS â•â• */
.groups{display:flex;flex-direction:column;gap:0;margin:14px 18px 18px;}
.sc-group{position:relative;border:1px solid var(--ga,rgba(0,245,255,.15));margin-bottom:14px;}
.sc-group:last-child{margin-bottom:0;}
.sc-group::before{content:'';position:absolute;inset:-1px;
  background:linear-gradient(135deg,var(--ga,rgba(0,245,255,.15)),transparent 40%,transparent 60%,var(--gb,rgba(255,0,144,.08)));
  pointer-events:none;z-index:0;opacity:.5;}
.sc-inner{position:relative;z-index:1;background:rgba(6,4,15,.96);}
.sc-head{padding:10px 16px;border-bottom:1px solid rgba(0,245,255,.08);display:flex;align-items:center;gap:12px;
  background:linear-gradient(90deg,rgba(6,4,15,.99),rgba(6,4,15,.85));}
.sc-head-hex{width:36px;height:36px;flex-shrink:0;
  clip-path:polygon(50% 0%,93% 25%,93% 75%,50% 100%,7% 75%,7% 25%);
  background:linear-gradient(135deg,rgba(0,245,255,.12),rgba(255,0,144,.06));
  border:1px solid var(--gc,var(--cyan));display:flex;align-items:center;justify-content:center;font-size:16px;
  box-shadow:0 0 14px rgba(0,245,255,.2);animation:hexglow2 3s ease-in-out infinite;}
@keyframes hexglow2{0%,100%{box-shadow:0 0 10px rgba(0,245,255,.2)}50%{box-shadow:0 0 22px rgba(0,245,255,.45)}}
.sc-head-info{flex:1;}
.sc-head-tag{font-family:'Orbitron',monospace;font-size:7px;letter-spacing:2.5px;color:var(--t3);margin-bottom:2px;}
.sc-head-name{font-family:'Orbitron',monospace;font-size:12px;letter-spacing:2px;color:var(--gc,var(--cyan));text-shadow:0 0 12px rgba(0,245,255,.4);}
.sc-head-right{text-align:right;flex-shrink:0;}
.sc-head-status{font-family:'Orbitron',monospace;font-size:8px;color:var(--grn);display:flex;align-items:center;gap:5px;justify-content:flex-end;}
.sc-head-nodes{font-size:9px;color:var(--t3);margin-top:3px;font-family:'Orbitron',monospace;letter-spacing:1px;}
.sc-cards{display:grid;grid-template-columns:repeat(3,1fr);gap:0;}
.sc-card{padding:16px;border-right:1px solid rgba(0,245,255,.07);cursor:pointer;position:relative;overflow:hidden;transition:background .2s;text-decoration:none;color:inherit;display:block;}
.sc-card:last-child{border-right:none;}
.sc-card:hover{background:rgba(0,245,255,.03);}
.sc-card::before{content:'';position:absolute;inset:0;z-index:0;
  background:linear-gradient(180deg,transparent 0%,rgba(0,245,255,.025) 50%,transparent 100%);
  background-size:100% 40px;opacity:0;transition:opacity .25s;animation:scanmove 2s linear infinite;}
@keyframes scanmove{0%{background-position:0 -40px}100%{background-position:0 200px}}
.sc-card:hover::before{opacity:1;}
.sc-card-inner{position:relative;z-index:2;}
.sc-card .brk{position:absolute;bottom:10px;right:10px;width:12px;height:12px;z-index:3;border-bottom:1px solid var(--t3);border-right:1px solid var(--t3);transition:.2s;}
.sc-card:hover .brk{border-color:var(--cc,var(--cyan));box-shadow:2px 2px 6px rgba(0,245,255,.2);width:16px;height:16px;bottom:8px;right:8px;}
.sc-card-topbar{height:1px;margin:-16px -16px 14px;background:linear-gradient(90deg,var(--cc,var(--cyan)),transparent);opacity:.5;transition:opacity .2s;}
.sc-card:hover .sc-card-topbar{opacity:1;}
.sc-card-glow{position:absolute;top:-30px;right:-30px;width:100px;height:100px;border-radius:50%;
  background:radial-gradient(var(--cc,rgba(0,245,255,.08)),transparent 70%);pointer-events:none;z-index:1;}
.sc-card-top{display:flex;align-items:center;gap:10px;margin-bottom:10px;}
.sc-card-ico-wrap{width:38px;height:38px;flex-shrink:0;position:relative;display:flex;align-items:center;justify-content:center;}
.sc-card-ico{font-size:20px;}
.sc-card-ring{position:absolute;inset:0;border:1px solid var(--cc,rgba(0,245,255,.3));border-radius:50%;animation:spin-slow 8s linear infinite;}
@keyframes spin-slow{to{transform:rotate(360deg)}}
.sc-card-ring::before{content:'';position:absolute;top:-2px;left:50%;transform:translateX(-50%);width:4px;height:4px;border-radius:50%;background:var(--cc,var(--cyan));box-shadow:0 0 8px var(--cc,var(--cyan));}
.sc-card-label{font-family:'Orbitron',monospace;font-size:7px;letter-spacing:2px;color:var(--t3);}
.sc-card-name{font-family:'Orbitron',sans-serif;font-size:12px;letter-spacing:1px;color:var(--cc,var(--cyan));margin-bottom:6px;line-height:1.3;text-shadow:0 0 10px rgba(0,245,255,.25);}
.sc-card-desc{font-size:12px;color:rgba(180,210,240,.85);line-height:1.5;margin-bottom:12px;}
.sc-card-footer{display:flex;align-items:center;justify-content:space-between;border-top:1px solid rgba(0,245,255,.08);padding-top:9px;}
.sc-card-tag{font-family:'Orbitron',monospace;font-size:7px;letter-spacing:1.5px;padding:2px 7px;border:1px solid rgba(0,245,255,.1);color:var(--t3);}
.sc-card-btn{font-family:'Orbitron',monospace;font-size:9px;letter-spacing:2px;color:var(--cc,var(--cyan));display:flex;align-items:center;gap:6px;text-shadow:0 0 8px currentColor;transition:gap .18s;}
.sc-card-btn-line{width:18px;height:1px;background:var(--cc,var(--cyan));transition:width .18s;}
.sc-card:hover .sc-card-btn{gap:10px;}
.sc-card:hover .sc-card-btn-line{width:28px;}
@keyframes rpl{0%{transform:scale(0);opacity:.35}100%{transform:scale(4);opacity:0}}
.rpl{position:absolute;width:60px;height:60px;border-radius:50%;background:rgba(0,245,255,.15);pointer-events:none;animation:rpl .55s ease-out forwards;transform-origin:center;z-index:5;}

/* â•â• FOOTER â•â• */
footer{background:rgba(0,0,0,.85);border-top:1px solid var(--bc);padding:9px 18px;
  display:flex;justify-content:space-between;flex-wrap:wrap;gap:6px;font-family:'Orbitron',sans-serif;
  box-shadow:0 0 20px rgba(0,245,255,.06);}
.fl{font-size:8px;color:var(--t3);letter-spacing:2px;text-transform:uppercase}
.fl span{color:var(--cyan);text-shadow:0 0 8px rgba(0,245,255,.4)}
.fr{font-size:8px;color:rgba(0,245,255,.45);letter-spacing:1px}

/* â•â• RESPONSIVE â•â• */
@media(max-width:960px){
  .stats{grid-template-columns:repeat(2,1fr)}
  .mbar{grid-template-columns:30px 1fr 30px 1fr;}
  .mbar-item{min-width:90px;padding:6px 10px;}
  .mbar-val{font-size:13px;}
}
@media(max-width:700px){
  .sc-cards{grid-template-columns:1fr;}
  .sc-card{border-right:none;border-bottom:1px solid rgba(0,245,255,.07);}
  .sc-card:last-child{border-bottom:none;}
  .stats{grid-template-columns:repeat(2,1fr)}
  .groups{margin:8px 10px 14px;}
  .mbar{grid-template-columns:24px 1fr 24px 1fr;}
  .mbar-label-txt{display:none;}
  .mbar-item{min-width:80px;padding:5px 8px;}
}
@media(max-width:560px){
  header{padding:10px 12px}
  .bsub,.pill.p{display:none}
  .bname{font-size:13px}.logo{width:40px;height:40px;font-size:18px}
  .tkr{display:none}
  .stats{grid-template-columns:repeat(2,1fr)}
  .sb .l{font-size:7px}.sb .v{font-size:13px}
  .sc-head-name{font-size:10px;}
  .sc-cards{grid-template-columns:1fr;}
  .mbar{grid-template-columns:1fr;}
  .mbar-label{display:none;}
  .mbar-items{flex-wrap:wrap;}
}

/* â”€â”€ FLOATING BACK BUTTON â”€â”€ */
#floatback{position:fixed;bottom:24px;right:24px;z-index:9999;display:none;align-items:center;gap:8px;padding:10px 18px;
  font-family:'Orbitron',sans-serif;font-size:10px;font-weight:700;letter-spacing:2px;
  color:var(--bg);background:var(--pink);border:none;cursor:pointer;
  clip-path:polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);
  box-shadow:0 0 24px rgba(255,0,144,.6),0 0 48px rgba(255,0,144,.3);
  animation:floatpulse 2s ease-in-out infinite;transition:transform .15s;}
#floatback:hover{transform:scale(1.06)}
#floatback.visible{display:flex}
@keyframes floatpulse{
  0%,100%{box-shadow:0 0 24px rgba(255,0,144,.6),0 0 48px rgba(255,0,144,.3)}
  50%{box-shadow:0 0 36px rgba(255,0,144,.9),0 0 64px rgba(255,0,144,.5)}}
#floatback .kbhint{font-size:7px;opacity:.7;letter-spacing:1px;border:1px solid rgba(0,0,0,.3);padding:1px 5px;border-radius:2px;background:rgba(0,0,0,.2);}

/* â•â• IFRAME VIEWER â•â• */
#viewer{position:fixed;inset:0;z-index:500;display:none;flex-direction:column;background:var(--bg);}
#viewer.open{display:flex}
#vbar{background:rgba(0,0,0,.92);border-bottom:1px solid var(--cyan);padding:6px 14px;
  display:flex;align-items:center;gap:12px;font-family:'Orbitron',sans-serif;font-size:9px;letter-spacing:2px;
  flex-shrink:0;box-shadow:0 0 20px rgba(0,245,255,.15);position:relative;z-index:501;}
#vtitle{color:var(--cyan);font-weight:700;font-size:11px;text-shadow:0 0 12px rgba(0,245,255,.5);flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.vring{display:flex;align-items:center;gap:6px;color:var(--yel)}
.vring svg{transform:rotate(-90deg);width:16px;height:16px;flex-shrink:0}
.vring circle{fill:none;stroke:rgba(255,224,0,.2);stroke-width:2}
.vring .varc{stroke:var(--yel);stroke-width:2;stroke-dasharray:44;stroke-dashoffset:0;transition:stroke-dashoffset 1s linear;filter:drop-shadow(0 0 4px var(--yel));}
#vrcd{font-size:9px;color:var(--yel);min-width:22px}
#vopen{padding:5px 12px;font-size:8px;letter-spacing:2px;font-family:'Orbitron',sans-serif;text-transform:uppercase;border:1px solid rgba(0,245,255,.3);color:var(--cyan);background:rgba(0,245,255,.05);cursor:pointer;transition:background .15s;}
#vopen:hover{background:rgba(0,245,255,.12)}
#vclose{padding:5px 14px;font-size:8px;letter-spacing:2px;font-family:'Orbitron',sans-serif;text-transform:uppercase;border:1px solid rgba(255,0,144,.4);color:var(--pink);background:rgba(255,0,144,.05);cursor:pointer;transition:background .15s;clip-path:polygon(6px 0%,100% 0%,calc(100% - 6px) 100%,0% 100%);}
#vclose:hover{background:rgba(255,0,144,.15)}
#vframe{flex:1;border:none;width:100%;background:#000;}
#vload{position:absolute;inset:48px 0 0 0;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;pointer-events:none;transition:opacity .4s;}
#vload.hidden{opacity:0}
.lspinner{width:40px;height:40px;border-radius:50%;border:2px solid rgba(0,245,255,.1);border-top-color:var(--cyan);animation:spin 1s linear infinite;box-shadow:0 0 16px rgba(0,245,255,.3);}
@keyframes spin{to{transform:rotate(360deg)}}
.ltxt{font-family:'Orbitron',sans-serif;font-size:9px;color:var(--t3);letter-spacing:3px}
</style>
</head>
<body>
<div id="scan"></div>
<div id="app">

<!-- â•â• TOPBAR â•â• -->
<div class="tb">
  <div class="tb-l">NIFTY INDIAN <span class="ver">MARKETS HUB // LIVE</span></div>
  <div class="tb-r">
    <span class="live"><span class="dot"></span>SIGNAL_OK</span>
    <span>IST <span class="v" id="ct">--:--:--</span></span>
  </div>
</div>

<!-- â•â• HEADER â•â• -->
<header>
  <div class="brand">
    <div class="logo">ğŸ“Š</div>
    <div>
      <div class="bname">NIFTY Indian <span>Markets HUB</span></div>
      <div class="bsub">Intelligence Hub Â· 8 Nodes Active</div>
    </div>
  </div>
  <div class="hright">
    <div class="pill g"><span class="dot"></span>ALL LIVE</div>
    <div class="pill p">NSE Â· BSE Â· NYSE</div>
    <div class="pill">IST <span id="ch">--:--:--</span></div>
  </div>
</header>

<!-- â•â• LIVE MARKET BAR â•â• -->
<div class="mbar" id="mbar">

  <!-- INDIA LABEL -->
  <div class="mbar-label india">
    <div class="mbar-label-flag">ğŸ‡®ğŸ‡³</div>
    <div class="mbar-label-txt">INDIA</div>
  </div>

  <!-- INDIA ITEMS -->
  <div class="mbar-items" id="mbar-india">
    <div class="mbar-item" id="mi-n50" style="--ic:var(--cyan);--is:rgba(0,245,255,.3);">
      <div class="mbar-name">NIFTY 50</div>
      <div class="mbar-val" id="mv-n50">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-n50">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-n50"></div>
    </div>
    <div class="mbar-item" id="mi-bn" style="--ic:var(--pink);--is:rgba(255,0,144,.3);">
      <div class="mbar-name">BANK NIFTY</div>
      <div class="mbar-val" id="mv-bn">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-bn">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-bn"></div>
    </div>
    <div class="mbar-item is-vix" id="mi-vix" style="--ic:var(--yel);--is:rgba(255,224,0,.3);">
      <div class="mbar-name">INDIA VIX</div>
      <div class="mbar-val" id="mv-vix">Â·Â·Â·</div>
      <div class="mbar-chg vix" id="mc-vix">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-vix"></div>
    </div>
    <div class="mbar-item" id="mi-fn" style="--ic:var(--grn);--is:rgba(0,255,136,.3);">
      <div class="mbar-name">FINNIFTY</div>
      <div class="mbar-val" id="mv-fn">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-fn">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-fn"></div>
    </div>
    <div class="mbar-item" id="mi-sx" style="--ic:var(--t2);--is:rgba(0,245,255,.2);">
      <div class="mbar-name">SENSEX</div>
      <div class="mbar-val" id="mv-sx">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-sx">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-sx"></div>
    </div>
  </div>

  <!-- GLOBAL LABEL -->
  <div class="mbar-label global">
    <div class="mbar-label-flag">ğŸŒ</div>
    <div class="mbar-label-txt">GLOBAL</div>
  </div>

  <!-- GLOBAL ITEMS -->
  <div class="mbar-items" id="mbar-global">
    <div class="mbar-item" id="mi-sp" style="--ic:var(--pink);--is:rgba(255,0,144,.3);">
      <div class="mbar-name">S&amp;P 500</div>
      <div class="mbar-val" id="mv-sp">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-sp">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-sp"></div>
    </div>
    <div class="mbar-item" id="mi-ndq" style="--ic:var(--pur);--is:rgba(157,0,255,.35);">
      <div class="mbar-name">NASDAQ</div>
      <div class="mbar-val" id="mv-ndq">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-ndq">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-ndq"></div>
    </div>
    <div class="mbar-item" id="mi-dji" style="--ic:var(--cyan);--is:rgba(0,245,255,.2);">
      <div class="mbar-name">DOW JONES</div>
      <div class="mbar-val" id="mv-dji">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-dji">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-dji"></div>
    </div>
    <div class="mbar-item" id="mi-inr" style="--ic:var(--yel);--is:rgba(255,224,0,.25);">
      <div class="mbar-name">USD/INR</div>
      <div class="mbar-val" id="mv-inr">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-inr">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-inr"></div>
    </div>
    <div class="mbar-item" id="mi-crude" style="--ic:rgba(255,160,0,.9);--is:rgba(255,160,0,.25);">
      <div class="mbar-name">CRUDE OIL</div>
      <div class="mbar-val" id="mv-crude">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-crude">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-crude"></div>
    </div>
    <div class="mbar-item" id="mi-gold" style="--ic:#ffd700;--is:rgba(255,215,0,.35);">
      <div class="mbar-name">GOLD</div>
      <div class="mbar-val" id="mv-gold">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-gold">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-gold"></div>
    </div>
    <div class="mbar-item" id="mi-silver" style="--ic:#c0c0c0;--is:rgba(192,192,192,.3);">
      <div class="mbar-name">SILVER</div>
      <div class="mbar-val" id="mv-silver">Â·Â·Â·</div>
      <div class="mbar-chg" id="mc-silver">Â·Â·Â·</div>
      <div class="mbar-src" id="ms-silver"></div>
    </div>
  </div>

  <div class="mbar-updated" id="mbar-ts"></div>
</div>

<!-- â•â• TICKER â•â• -->
<div class="tkr"><div class="tkr-t" id="tkr"></div></div>

<!-- â•â• STATS â•â• -->
<div class="stats">
  <div class="sb" style="--sc:#00f5ff;--sg:'08'">
    <div class="l">Nodes Online</div>
    <div class="v">08</div>
    <div class="s">All dashboards active</div>
  </div>
  <div class="sb" style="--sc:#00ff88;--sg:'IN'">
    <div class="l">Indian Markets</div>
    <div class="v">NSE Â· BSE</div>
    <div class="s">Nifty Â· Sensex Â· OPT</div>
  </div>
  <div class="sb" style="--sc:#ffe000;--sg:'US'">
    <div class="l">US Markets</div>
    <div class="v">S&amp;P 500</div>
    <div class="s">500 stocks tracked</div>
  </div>
  <div class="sb" style="--sc:#ff0090;--sg:'â—ˆ'">
    <div class="l">Last Node</div>
    <div class="v" id="lc" style="font-size:12px;padding-top:2px">â€”</div>
    <div class="s">Session log</div>
  </div>
</div>

<!-- â•â• SECTION â•â• -->
<div class="sec">
  <div class="sec-bar"></div>
  <div class="sec-txt">â–¶ Select Dashboard Node</div>
  <div class="sec-bdg">8/8 ONLINE</div>
</div>

<!-- â•â• GROUPED PODS â•â• -->
<div class="groups">

  <!-- GROUP 1: NIFTY INTELLIGENCE -->
  <div class="sc-group" style="--ga:rgba(0,245,255,.22);--gb:rgba(0,245,255,.04);--gc:var(--cyan);">
    <div class="sc-inner">
      <div class="sc-head">
        <div class="sc-head-hex" style="border-color:var(--cyan);box-shadow:0 0 14px rgba(0,245,255,.3);">ğŸ“Š</div>
        <div class="sc-head-info">
          <div class="sc-head-tag">GROUP 01 // NSE ANALYTICS SUITE</div>
          <div class="sc-head-name" style="color:var(--cyan);">NIFTY INTELLIGENCE</div>
        </div>
        <div class="sc-head-right">
          <div class="sc-head-status"><span class="dot"></span>3 NODES ONLINE</div>
          <div class="sc-head-nodes">NSE Â· INDIA MARKETS</div>
        </div>
      </div>
      <div class="sc-cards">
        <a class="sc-card" href="https://krishnateja08.github.io/Nifty_50_Stock_Analyzer/" onclick="go(event,'Nifty 50 Analyzer')" style="--cc:var(--cyan);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar"></div><div class="sc-card-glow"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">ğŸ“ˆ</div><div class="sc-card-ring" style="border-color:rgba(0,245,255,.35);"></div></div>
              <div class="sc-card-label">ANALYSIS</div>
            </div>
            <div class="sc-card-name">Nifty 50 Analyzer</div>
            <div class="sc-card-desc">Deep technical analysis of all Nifty 50 stocks â€” RSI, MACD, EMA, support &amp; resistance levels.</div>
            <div class="sc-card-footer"><span class="sc-card-tag">NSE Â· NIFTY 50</span><div class="sc-card-btn"><div class="sc-card-btn-line"></div>LAUNCH</div></div>
          </div>
        </a>
        <a class="sc-card" href="https://krishnateja08.github.io/Nifty_Indices_scanner/" onclick="go(event,'Nifty Indices Scanner')" style="--cc:var(--cyan);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar"></div><div class="sc-card-glow"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">ğŸ”</div><div class="sc-card-ring" style="border-color:rgba(0,245,255,.35);animation-delay:-2.5s;"></div></div>
              <div class="sc-card-label">SCANNER</div>
            </div>
            <div class="sc-card-name">Nifty Indices Scanner</div>
            <div class="sc-card-desc">Real-time scanner across all Nifty indices â€” momentum, breakouts and sector rotation signals.</div>
            <div class="sc-card-footer"><span class="sc-card-tag">NSE Â· INDICES</span><div class="sc-card-btn"><div class="sc-card-btn-line"></div>LAUNCH</div></div>
          </div>
        </a>
        <a class="sc-card" href="https://krishnateja08.github.io/FII-DII_Pulse/" onclick="go(event,'FII/DII Pulse')" style="--cc:var(--cyan);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar"></div><div class="sc-card-glow"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">ğŸ›ï¸</div><div class="sc-card-ring" style="border-color:rgba(0,245,255,.35);animation-delay:-5s;"></div></div>
              <div class="sc-card-label">INSTITUTIONAL</div>
            </div>
            <div class="sc-card-name">FII / DII Pulse</div>
            <div class="sc-card-desc">Sector-wise institutional activity â€” FII &amp; DII bulk/block deals with technical signals &amp; RSI.</div>
            <div class="sc-card-footer"><span class="sc-card-tag">NSE Â· BULK DEALS</span><div class="sc-card-btn"><div class="sc-card-btn-line"></div>LAUNCH</div></div>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- GROUP 2: OPTIONS COMMAND -->
  <div class="sc-group" style="--ga:rgba(255,0,144,.22);--gb:rgba(255,0,144,.04);--gc:var(--pink);">
    <div class="sc-inner">
      <div class="sc-head" style="background:linear-gradient(90deg,rgba(6,4,15,.99),rgba(6,4,15,.85));">
        <div class="sc-head-hex" style="border-color:var(--pink);box-shadow:0 0 14px rgba(255,0,144,.3);background:linear-gradient(135deg,rgba(255,0,144,.12),rgba(157,0,255,.06));">â›“ï¸</div>
        <div class="sc-head-info">
          <div class="sc-head-tag">GROUP 02 // OPTIONS &amp; DERIVATIVES DESK</div>
          <div class="sc-head-name" style="color:var(--pink);text-shadow:0 0 12px rgba(255,0,144,.4);">OPTIONS COMMAND</div>
        </div>
        <div class="sc-head-right">
          <div class="sc-head-status"><span class="dot"></span>3 NODES ONLINE</div>
          <div class="sc-head-nodes">NSE Â· DERIVATIVES</div>
        </div>
      </div>
      <div class="sc-cards">
        <a class="sc-card" href="https://krishnateja08.github.io/Nifty_option_chain/" onclick="go(event,'Nifty Option Chain')" style="--cc:var(--pink);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar" style="background:linear-gradient(90deg,var(--pink),transparent);"></div>
            <div class="sc-card-glow" style="background:radial-gradient(rgba(255,0,144,.1),transparent 70%);"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">â›“ï¸</div><div class="sc-card-ring" style="border-color:rgba(255,0,144,.4);"></div></div>
              <div class="sc-card-label">OPTIONS</div>
            </div>
            <div class="sc-card-name" style="color:var(--pink);text-shadow:0 0 10px rgba(255,0,144,.3);">Nifty Option Chain</div>
            <div class="sc-card-desc">Live option chain analysis â€” OI buildup, PCR ratio, max pain and key strike price levels.</div>
            <div class="sc-card-footer" style="border-top-color:rgba(255,0,144,.1);">
              <span class="sc-card-tag" style="border-color:rgba(255,0,144,.15);">NSE Â· OPTIONS</span>
              <div class="sc-card-btn" style="color:var(--pink);"><div class="sc-card-btn-line" style="background:var(--pink);"></div>LAUNCH</div>
            </div>
          </div>
        </a>
        <a class="sc-card" href="https://krishnateja08.github.io/Nifty-1HR_Track/" onclick="go(event,'Nifty 1HR Track')" style="--cc:var(--pink);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar" style="background:linear-gradient(90deg,var(--pink),transparent);"></div>
            <div class="sc-card-glow" style="background:radial-gradient(rgba(255,0,144,.08),transparent 70%);"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">â±ï¸</div><div class="sc-card-ring" style="border-color:rgba(255,0,144,.4);animation-delay:-3s;"></div></div>
              <div class="sc-card-label">INTRADAY</div>
            </div>
            <div class="sc-card-name" style="color:var(--pink);text-shadow:0 0 10px rgba(255,0,144,.3);">Nifty 1HR Track</div>
            <div class="sc-card-desc">Hourly Nifty movement tracking â€” intraday trend analysis and short-term momentum signals.</div>
            <div class="sc-card-footer" style="border-top-color:rgba(255,0,144,.1);">
              <span class="sc-card-tag" style="border-color:rgba(255,0,144,.15);">NSE Â· INTRADAY</span>
              <div class="sc-card-btn" style="color:var(--pink);"><div class="sc-card-btn-line" style="background:var(--pink);"></div>LAUNCH</div>
            </div>
          </div>
        </a>
        <a class="sc-card" href="https://krishnateja08.github.io/optionstrategybuilder/" onclick="go(event,'Strategy Builder')" style="--cc:var(--pink);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar" style="background:linear-gradient(90deg,var(--pink),transparent);"></div>
            <div class="sc-card-glow" style="background:radial-gradient(rgba(255,0,144,.08),transparent 70%);"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">ğŸ§®</div><div class="sc-card-ring" style="border-color:rgba(255,0,144,.4);animation-delay:-6s;"></div></div>
              <div class="sc-card-label">STRATEGY</div>
            </div>
            <div class="sc-card-name" style="color:var(--pink);text-shadow:0 0 10px rgba(255,0,144,.3);">Option Strategy Builder</div>
            <div class="sc-card-desc">Build and visualise options strategies â€” P&amp;L charts, Greeks, breakeven for any strike &amp; expiry.</div>
            <div class="sc-card-footer" style="border-top-color:rgba(255,0,144,.1);">
              <span class="sc-card-tag" style="border-color:rgba(255,0,144,.15);">NSE Â· P&amp;L Â· GREEKS</span>
              <div class="sc-card-btn" style="color:var(--pink);"><div class="sc-card-btn-line" style="background:var(--pink);"></div>LAUNCH</div>
            </div>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- GROUP 3: GLOBAL INTELLIGENCE -->
  <div class="sc-group" style="--ga:rgba(255,224,0,.2);--gb:rgba(255,224,0,.04);--gc:var(--yel);">
    <div class="sc-inner">
      <div class="sc-head" style="background:linear-gradient(90deg,rgba(6,4,15,.99),rgba(6,4,15,.85));">
        <div class="sc-head-hex" style="border-color:var(--yel);box-shadow:0 0 14px rgba(255,224,0,.25);background:linear-gradient(135deg,rgba(255,224,0,.1),rgba(255,160,0,.05));">ğŸŒ</div>
        <div class="sc-head-info">
          <div class="sc-head-tag">GROUP 03 // MACRO &amp; GLOBAL MARKETS</div>
          <div class="sc-head-name" style="color:var(--yel);text-shadow:0 0 12px rgba(255,224,0,.35);">GLOBAL INTELLIGENCE</div>
        </div>
        <div class="sc-head-right">
          <div class="sc-head-status"><span class="dot"></span>2 NODES ONLINE</div>
          <div class="sc-head-nodes">NYSE Â· GLOBAL</div>
        </div>
      </div>
      <div class="sc-cards">
        <a class="sc-card" href="https://krishnateja08.github.io/USA-SP500-Stocks-Review/" onclick="go(event,'S&P 500 Review')" style="--cc:var(--yel);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar" style="background:linear-gradient(90deg,var(--yel),transparent);"></div>
            <div class="sc-card-glow" style="background:radial-gradient(rgba(255,224,0,.08),transparent 70%);"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">ğŸ—½</div><div class="sc-card-ring" style="border-color:rgba(255,224,0,.4);"></div></div>
              <div class="sc-card-label">GLOBAL</div>
            </div>
            <div class="sc-card-name" style="color:var(--yel);text-shadow:0 0 10px rgba(255,224,0,.3);">USA S&amp;P 500 Review</div>
            <div class="sc-card-desc">Comprehensive S&amp;P 500 stock review â€” US market analysis, sector performance and signals.</div>
            <div class="sc-card-footer" style="border-top-color:rgba(255,224,0,.1);">
              <span class="sc-card-tag" style="border-color:rgba(255,224,0,.2);">NYSE Â· S&amp;P 500</span>
              <div class="sc-card-btn" style="color:var(--yel);"><div class="sc-card-btn-line" style="background:var(--yel);"></div>LAUNCH</div>
            </div>
          </div>
        </a>
        <a class="sc-card" href="https://krishnateja08.github.io/Global_Market_News/" onclick="go(event,'Global Market News')" style="--cc:var(--yel);">
          <div class="brk"></div>
          <div class="sc-card-inner">
            <div class="sc-card-topbar" style="background:linear-gradient(90deg,var(--yel),transparent);"></div>
            <div class="sc-card-glow" style="background:radial-gradient(rgba(255,224,0,.07),transparent 70%);"></div>
            <div class="sc-card-top">
              <div class="sc-card-ico-wrap"><div class="sc-card-ico">ğŸŒ</div><div class="sc-card-ring" style="border-color:rgba(255,224,0,.4);animation-delay:-4s;"></div></div>
              <div class="sc-card-label">INTELLIGENCE</div>
            </div>
            <div class="sc-card-name" style="color:var(--yel);text-shadow:0 0 10px rgba(255,224,0,.3);">Global Market News</div>
            <div class="sc-card-desc">Curated global market news â€” macro events, earnings, central bank decisions and market moves.</div>
            <div class="sc-card-footer" style="border-top-color:rgba(255,224,0,.1);">
              <span class="sc-card-tag" style="border-color:rgba(255,224,0,.2);">GLOBAL Â· NEWS</span>
              <div class="sc-card-btn" style="color:var(--yel);"><div class="sc-card-btn-line" style="background:var(--yel);"></div>LAUNCH</div>
            </div>
          </div>
        </a>
        <div class="sc-card" style="cursor:default;opacity:.18;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:8px;min-height:160px;">
          <div style="font-family:'Orbitron',monospace;font-size:28px;color:var(--yel);">+</div>
          <div style="font-family:'Orbitron',monospace;font-size:7px;letter-spacing:3px;color:var(--yel);">EXPAND NODE</div>
        </div>
      </div>
    </div>
  </div>

</div><!-- /groups -->

<!-- â•â• FOOTER â•â• -->
<footer>
  <div class="fl"><span>NIFTY INDIAN MARKETS HUB</span> // CYBER_NEON v2.1 // 8_NODES_ACTIVE</div>
  <div class="fr">SELECT_NODE â†’ OPEN // BACK â†’ RETURN_TO_HUB</div>
</footer>
</div><!-- /#app -->

<button id="floatback" onclick="closeViewer()">â† HUB <span class="kbhint">ESC</span></button>

<div id="viewer">
  <div id="vbar">
    <div id="vtitle">â€” NODE VIEWER â€”</div>
    <div class="vring">
      <svg viewBox="0 0 16 16"><circle cx="8" cy="8" r="7"/><circle class="varc" id="varc" cx="8" cy="8" r="7"/></svg>
      REFRESH <span id="vrcd">30s</span>
    </div>
    <button id="vopen" onclick="openExternal()">â†— OPEN TAB</button>
    <button id="vclose" onclick="closeViewer()">âœ• BACK TO HUB</button>
  </div>
  <div id="vload"><div class="lspinner"></div><div class="ltxt">LOADING NODE...</div></div>
  <iframe id="vframe" src="about:blank"></iframe>
</div>

<script>
/* â•â• IST Clock â•â• */
function tick(){
  const t=new Intl.DateTimeFormat('en-IN',{timeZone:'Asia/Kolkata',hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false}).format(new Date());
  document.getElementById('ct').textContent=t;
  document.getElementById('ch').textContent=t;
}
tick();setInterval(tick,1000);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MARKET BAR ENGINE v3.0
   
   INDIA  â†’ NSE allIndices API (primary) | Yahoo Finance (fallback)
   GLOBAL â†’ investing.com page scrape (primary) | Yahoo Finance (fallback)
   
   Gold & Silver now included via investing.com / Yahoo
   Races all proxies simultaneously â€” fastest one wins
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

const MB_MAP = [
  /* India â€” NSE primary */
  { id:'n50',    valId:'mv-n50',    chgId:'mc-n50',    srcId:'ms-n50',    yf:'^NSEI',              nseKey:'NIFTY 50',          invKey:'S&P 500',  prefix:'',   isVix:false },
  { id:'bn',     valId:'mv-bn',     chgId:'mc-bn',     srcId:'ms-bn',     yf:'^NSEBANK',           nseKey:'NIFTY BANK',        invKey:null,       prefix:'',   isVix:false },
  { id:'vix',    valId:'mv-vix',    chgId:'mc-vix',    srcId:'ms-vix',    yf:'^INDIAVIX',          nseKey:'INDIA VIX',         invKey:null,       prefix:'',   isVix:true  },
  { id:'fn',     valId:'mv-fn',     chgId:'mc-fn',     srcId:'ms-fn',     yf:'NIFTY_FIN_SERVICE.NS',nseKey:'NIFTY FIN SERVICE',invKey:null,       prefix:'',   isVix:false },
  { id:'sx',     valId:'mv-sx',     chgId:'mc-sx',     srcId:'ms-sx',     yf:'^BSESN',             nseKey:'SENSEX',            invKey:null,       prefix:'',   isVix:false },
  /* Global â€” investing.com primary, Yahoo fallback */
  { id:'sp',     valId:'mv-sp',     chgId:'mc-sp',     srcId:'ms-sp',     yf:'^GSPC',              nseKey:null, invKey:'S&P 500',      prefix:'',   isVix:false },
  { id:'ndq',    valId:'mv-ndq',    chgId:'mc-ndq',    srcId:'ms-ndq',    yf:'^IXIC',              nseKey:null, invKey:'Nasdaq',       prefix:'',   isVix:false },
  { id:'dji',    valId:'mv-dji',    chgId:'mc-dji',    srcId:'ms-dji',    yf:'^DJI',               nseKey:null, invKey:'Dow Jones',    prefix:'',   isVix:false },
  { id:'inr',    valId:'mv-inr',    chgId:'mc-inr',    srcId:'ms-inr',    yf:'INR=X',              nseKey:null, invKey:null,           prefix:'',   isVix:false },
  { id:'crude',  valId:'mv-crude',  chgId:'mc-crude',  srcId:'ms-crude',  yf:'CL=F',               nseKey:null, invKey:'Crude Oil WTI',prefix:'$',  isVix:false },
  { id:'gold',   valId:'mv-gold',   chgId:'mc-gold',   srcId:'ms-gold',   yf:'GC=F',               nseKey:null, invKey:'Gold',         prefix:'$',  isVix:false },
  { id:'silver', valId:'mv-silver', chgId:'mc-silver', srcId:'ms-silver', yf:'SI=F',               nseKey:null, invKey:'Silver',       prefix:'$',  isVix:false },
];

function fmtV(n, d=2){
  if(n==null||isNaN(n)) return 'â€”';
  return n>=1000
    ? n.toLocaleString('en-IN',{minimumFractionDigits:d,maximumFractionDigits:d})
    : n.toFixed(d);
}

function silentUpdate(item, price, chgPct, source){
  const valEl = document.getElementById(item.valId);
  const chgEl = document.getElementById(item.chgId);
  const srcEl = document.getElementById(item.srcId);
  if(!valEl||!chgEl) return;
  const up = chgPct >= 0;
  const newVal = item.prefix + fmtV(price, 2);
  const newChg = (up ? 'â–² +' : 'â–¼ ') + Math.abs(chgPct).toFixed(2) + '%';
  if(valEl.textContent !== newVal){
    valEl.textContent = newVal;
    valEl.classList.remove('val-updated');
    void valEl.offsetWidth;
    valEl.classList.add('val-updated');
  }
  if(chgEl.textContent !== newChg){
    chgEl.textContent = newChg;
    chgEl.className = item.isVix ? 'mbar-chg vix' : (up ? 'mbar-chg up' : 'mbar-chg dn');
  }
  if(srcEl && source){
    srcEl.textContent = source;
    srcEl.className = 'mbar-src ' + (source==='NSE' ? 'nse' : source==='INV' ? 'nse' : 'yf');
  }
}

function setTs(){
  const ts = document.getElementById('mbar-ts');
  if(ts){
    const now = new Intl.DateTimeFormat('en-IN',{timeZone:'Asia/Kolkata',hour:'2-digit',minute:'2-digit',hour12:false}).format(new Date());
    ts.textContent = 'UPD ' + now;
  }
}

function parseProxyResponse(j){
  if(j && typeof j.contents === 'string'){
    try { return JSON.parse(j.contents); } catch(e){ return null; }
  }
  if(typeof j === 'string'){
    try { return JSON.parse(j); } catch(e){ return null; }
  }
  return j;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SOURCE A: NSE India allIndices
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function fetchNSEIndices(){
  const url = 'https://www.nseindia.com/api/allIndices';
  const proxies = [
    `https://corsproxy.io/?${encodeURIComponent(url)}`,
    `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`,
  ];
  for(const px of proxies){
    try{
      const r = await fetch(px, { signal: AbortSignal.timeout(6000), cache:'no-store' });
      if(!r.ok) continue;
      let j = parseProxyResponse(await r.json());
      if(!j) continue;
      const data = j.data || [];
      if(data.length >= 2){ console.log('[NSE] ok:', data.length, 'indices'); return data; }
    } catch(e){ console.warn('[NSE]', e.message); }
  }
  return [];
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SOURCE B: investing.com page scrape
   Fetches the analysis page which contains
   all global prices in its plain text.
   Parses with regex â€” no API key needed.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function fetchInvestingCom(){
  const url = 'https://www.investing.com/analysis/stock-markets';
  const proxies = [
    `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`,
    `https://corsproxy.io/?${encodeURIComponent(url)}`,
  ];

  for(const px of proxies){
    try{
      const r = await fetch(px, { signal: AbortSignal.timeout(10000), cache:'no-store' });
      if(!r.ok) continue;
      let raw = await r.json();
      // allorigins wraps in .contents
      const text = raw.contents || (typeof raw === 'string' ? raw : null);
      if(!text || text.length < 5000) continue;

      console.log('[INV] page fetched, length:', text.length);

      // Parse key/value pairs from the text using patterns like:
      // [S&P 500](url) 

 6,909.51 

 +47.62 

 +0.69%
      const data = {};

      const patterns = [
        { key:'S&P 500',       regex:/S&P 500[^
]*
+[\s]*([\d,]+\.?\d*)
+[\s]*([\+\-][\d,\.]+)
+[\s]*([\+\-][\d\.]+)%/ },
        { key:'Nasdaq',        regex:/Nasdaq[^
]*
+[\s]*([\d,]+\.?\d*)
+[\s]*([\+\-][\d,\.]+)
+[\s]*([\+\-][\d\.]+)%/ },
        { key:'Dow Jones',     regex:/Dow Jones[^
]*
+[\s]*([\d,]+\.?\d*)
+[\s]*([\+\-][\d,\.]+)
+[\s]*([\+\-][\d\.]+)%/ },
        { key:'Crude Oil WTI', regex:/Crude Oil WTI[^
]*
+[\s]*([\d,]+\.?\d*)
+[\s]*([\+\-][\d,\.]+)
+[\s]*([\+\-][\d\.]+)%/ },
        { key:'Gold',          regex:/Gold Futures[^
]*
+[\s]*([\d,]+\.?\d*)
+[\s]*([\+\-][\d,\.]+)
+[\s]*([\+\-][\d\.]+)%/ },
        { key:'Silver',        regex:/Silver Futures[^
]*
+[\s]*([\d,]+\.?\d*)
+[\s]*([\+\-][\d,\.]+)
+[\s]*([\+\-][\d\.]+)%/ },
      ];

      for(const p of patterns){
        const m = text.match(p.regex);
        if(m){
          const price = parseFloat(m[1].replace(/,/g,''));
          const chgPct = parseFloat(m[3]);
          if(!isNaN(price)){
            data[p.key] = { price, chgPct };
            console.log('[INV]', p.key, price, chgPct+'%');
          }
        }
      }

      if(Object.keys(data).length >= 2) return data;
    } catch(e){ console.warn('[INV] failed:', e.message); }
  }
  return {};
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SOURCE C: Yahoo Finance â€” race all proxies
   Used as fallback for anything not from NSE/INV
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function fetchYahoo(){
  const syms = MB_MAP.map(x => x.yf).join(',');
  const yfBase  = `https://query2.finance.yahoo.com/v8/finance/quote?symbols=${encodeURIComponent(syms)}&fields=regularMarketPrice,regularMarketChangePercent`;
  const yfBase1 = yfBase.replace('query2','query1');

  const candidates = [
    `https://corsproxy.io/?${encodeURIComponent(yfBase)}`,
    `https://corsproxy.io/?${encodeURIComponent(yfBase1)}`,
    `https://api.allorigins.win/get?url=${encodeURIComponent(yfBase)}`,
    `https://api.allorigins.win/get?url=${encodeURIComponent(yfBase1)}`,
  ];

  return new Promise((resolve) => {
    let settled = 0, resolved = false;
    candidates.forEach(px => {
      fetch(px, { signal: AbortSignal.timeout(9000), cache:'no-store' })
        .then(r => r.ok ? r.json() : Promise.reject('bad'))
        .then(raw => {
          const j = parseProxyResponse(raw);
          if(!j) return;
          const results = j?.quoteResponse?.result || [];
          if(results.length > 0 && !resolved){
            resolved = true;
            console.log('[YF] ok via:', px.split('?')[0], '|', results.length, 'quotes');
            resolve(results);
          }
        })
        .catch(e => console.warn('[YF]', e.message||e))
        .finally(() => { settled++; if(settled===candidates.length && !resolved) resolve([]); });
    });
  });
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MAIN REFRESH
   Step 1: NSE â†’ Indian indices immediately
   Step 2: investing.com â†’ Global prices
   Step 3: Yahoo â†’ fill anything still missing
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function refreshMarketBar(){
  let updated = 0;

  /* â”€â”€ STEP 1: NSE â€” fast, update Indians immediately â”€â”€ */
  const nseArr = await fetchNSEIndices();
  for(const item of MB_MAP){
    if(!item.nseKey || !nseArr.length) continue;
    const found = nseArr.find(d =>
      d.index === item.nseKey ||
      d.indexSymbol === item.nseKey ||
      (d.index||'').toLowerCase() === item.nseKey.toLowerCase()
    );
    if(found && found.last != null){
      silentUpdate(item, parseFloat(found.last), parseFloat(found.percentChange), 'NSE');
      updated++;
    }
  }
  if(updated > 0) setTs();

  /* â”€â”€ STEP 2: investing.com â€” global indices â”€â”€ */
  const invData = await fetchInvestingCom();
  for(const item of MB_MAP){
    if(!item.invKey) continue;
    const d = invData[item.invKey];
    if(d){
      silentUpdate(item, d.price, d.chgPct, 'INV');
      updated++;
    }
  }
  if(updated > 0) setTs();

  /* â”€â”€ STEP 3: Yahoo â€” fill anything still showing Â·Â·Â· â”€â”€ */
  const yfArr = await fetchYahoo();
  for(const item of MB_MAP){
    const valEl = document.getElementById(item.valId);
    if(!valEl) continue;
    const alreadyFilled = valEl.textContent !== 'Â·Â·Â·' && valEl.textContent !== 'â€”';
    if(alreadyFilled) continue;
    const q = yfArr.find(x => x.symbol === item.yf);
    if(q?.regularMarketPrice != null){
      silentUpdate(item, q.regularMarketPrice, q.regularMarketChangePercent || 0, 'YF');
      updated++;
    }
  }
  if(updated > 0) setTs();
  console.log(`[MBar] Total: ${updated}/${MB_MAP.length} updated`);
}

/* Kick off immediately, then every 60 seconds (investing.com rate limit friendly) */
refreshMarketBar();
setInterval(refreshMarketBar, 60000);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TICKER â€” Multi-Source Engine
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const TICKER_STOCKS=[
  {s:'RELIANCE',sym:'RELIANCE',prefix:'â‚¹'},{s:'TCS',sym:'TCS',prefix:'â‚¹'},
  {s:'HDFCBANK',sym:'HDFCBANK',prefix:'â‚¹'},{s:'INFY',sym:'INFY',prefix:'â‚¹'},
  {s:'ICICIBANK',sym:'ICICIBANK',prefix:'â‚¹'},{s:'SBIN',sym:'SBIN',prefix:'â‚¹'},
  {s:'WIPRO',sym:'WIPRO',prefix:'â‚¹'},{s:'AXISBANK',sym:'AXISBANK',prefix:'â‚¹'},
  {s:'ITC',sym:'ITC',prefix:'â‚¹'},{s:'LT',sym:'LT',prefix:'â‚¹'},
];
const TICKER_INDICES=[
  {s:'NIFTY 50',key:'NIFTY 50'},{s:'SENSEX',key:'SENSEX'},
  {s:'BANK NIFTY',key:'NIFTY BANK'},{s:'FINNIFTY',key:'NIFTY FIN SERVICE'},
];
function fmt(n,d=2){if(n==null||isNaN(n))return'â€”';return n>=1000?n.toLocaleString('en-IN',{minimumFractionDigits:d,maximumFractionDigits:d}):n.toFixed(d);}
function renderTicker(items){
  const tkr=document.getElementById('tkr');
  tkr.innerHTML=[...items,...items].map(t=>`<span class="ti"><span class="s">${t.s}</span><span>${t.v}</span><span class="${t.u?'up':'dn'}">${t.c}</span></span>`).join('');
}
async function fromNSETicker(){
  const items=[];
  const proxies=[
    `https://corsproxy.io/?${encodeURIComponent('https://www.nseindia.com/api/allIndices')}`,
    `https://api.allorigins.win/get?url=${encodeURIComponent('https://www.nseindia.com/api/allIndices')}`,
  ];
  let indices=[];
  for(const px of proxies){
    try{
      const r=await fetch(px,{signal:AbortSignal.timeout(7000),cache:'no-store',headers:{'Accept':'application/json'}});
      let j=await r.json();
      if(j.contents)j=JSON.parse(j.contents);
      indices=j.data||[];
      if(indices.length>=2) break;
    }catch(e){}
  }
  for(const ti of TICKER_INDICES){
    const found=indices.find(i=>i.index===ti.key||i.indexSymbol===ti.key);
    if(found){const up=parseFloat(found.percentChange)>=0;items.push({s:ti.s,v:fmt(found.last,2),c:(up?'+':'')+parseFloat(found.percentChange).toFixed(2)+'%',u:up?1:0});}
  }
  /* Try NSE equity quotes for stocks */
  for(const st of TICKER_STOCKS){
    try{
      const sUrl=`https://www.nseindia.com/api/quote-equity?symbol=${encodeURIComponent(st.sym)}`;
      const proxies2=[`https://corsproxy.io/?${encodeURIComponent(sUrl)}`,`https://api.allorigins.win/get?url=${encodeURIComponent(sUrl)}`];
      for(const px2 of proxies2){
        try{
          const sr=await fetch(px2,{signal:AbortSignal.timeout(5000),cache:'no-store',headers:{'Accept':'application/json'}});
          let sd=await sr.json();
          if(sd.contents)sd=JSON.parse(sd.contents);
          const price=sd?.priceInfo?.lastPrice,chg=sd?.priceInfo?.pChange;
          if(price!=null){const up=chg>=0;items.push({s:st.s,v:st.prefix+fmt(price,2),c:(up?'+':'')+parseFloat(chg).toFixed(2)+'%',u:up?1:0});break;}
        }catch(e){}
      }
    }catch(e){}
  }
  return items;
}
async function fromYahooTicker(){
  const YF_SYMS=[
    {s:'NIFTY 50',yf:'^NSEI',p:''},{s:'SENSEX',yf:'^BSESN',p:''},{s:'BANK NIFTY',yf:'^NSEBANK',p:''},
    {s:'RELIANCE',yf:'RELIANCE.NS',p:'â‚¹'},{s:'TCS',yf:'TCS.NS',p:'â‚¹'},{s:'HDFCBANK',yf:'HDFCBANK.NS',p:'â‚¹'},
    {s:'INFY',yf:'INFY.NS',p:'â‚¹'},{s:'ICICIBANK',yf:'ICICIBANK.NS',p:'â‚¹'},{s:'SBIN',yf:'SBIN.NS',p:'â‚¹'},
    {s:'ITC',yf:'ITC.NS',p:'â‚¹'},{s:'S&P 500',yf:'^GSPC',p:''},{s:'NASDAQ',yf:'^IXIC',p:''},
    {s:'USD/INR',yf:'INR=X',p:''},{s:'CRUDE',yf:'CL=F',p:'$'},{s:'GOLD',yf:'GC=F',p:'$'},{s:'SILVER',yf:'SI=F',p:'$'},
  ];
  const syms=YF_SYMS.map(x=>x.yf).join(',');
  const base=`https://query2.finance.yahoo.com/v8/finance/quote?symbols=${encodeURIComponent(syms)}&fields=regularMarketPrice,regularMarketChangePercent`;
  const proxies=[
    `https://corsproxy.io/?${encodeURIComponent(base)}`,
    `https://api.allorigins.win/get?url=${encodeURIComponent(base)}`,
    `https://thingproxy.freeboard.io/fetch/${base}`,
    `https://corsproxy.io/?${encodeURIComponent(base.replace('query2','query1'))}`,
    `https://api.allorigins.win/get?url=${encodeURIComponent(base.replace('query2','query1'))}`,
  ];
  for(const px of proxies){
    try{
      const r=await fetch(px,{signal:AbortSignal.timeout(8000),cache:'no-store',headers:{'Accept':'application/json'}});
      let raw=await r.json();
      if(raw.contents)raw=JSON.parse(raw.contents);
      if(typeof raw==='string')raw=JSON.parse(raw);
      const quotes=raw?.quoteResponse?.result||[];
      if(!quotes.length)continue;
      return YF_SYMS.map(sym=>{const q=quotes.find(x=>x.symbol===sym.yf);if(!q?.regularMarketPrice)return null;const up=q.regularMarketChangePercent>=0;return{s:sym.s,v:sym.p+fmt(q.regularMarketPrice,2),c:(up?'+':'')+q.regularMarketChangePercent.toFixed(2)+'%',u:up?1:0};}).filter(Boolean);
    }catch(e){}
  }
  return[];
}
async function fetchLiveTicker(){
  try{const items=await fromNSETicker();if(items.length>=4){renderTicker(items);return;}}catch(e){}
  try{const items=await fromYahooTicker();if(items.length>=4){renderTicker(items);return;}}catch(e){}
}
fetchLiveTicker();
setInterval(fetchLiveTicker,60000);

/* â•â• Session â•â• */
const l=sessionStorage.getItem('lo');
if(l)document.getElementById('lc').textContent=l;

/* â•â• Iframe Viewer â•â• */
const IFRAME_REFRESH=30;let currentUrl='',viewerTimer=null,viewerRem=IFRAME_REFRESH;
const viewer=document.getElementById('viewer'),vframe=document.getElementById('vframe'),
  vtitle=document.getElementById('vtitle'),vload=document.getElementById('vload'),
  vrcd=document.getElementById('vrcd'),varc=document.getElementById('varc'),VARC_C=44;
function openViewer(url,name){currentUrl=url;vtitle.textContent='â–¶ '+name.toUpperCase();viewer.classList.add('open');document.body.style.overflow='hidden';document.getElementById('floatback').classList.add('visible');loadFrame();startViewerTimer();}
function loadFrame(){vload.classList.remove('hidden');vframe.src=currentUrl+(currentUrl.includes('?')?'&':'?')+'_t='+Date.now();vframe.onload=()=>{vload.classList.add('hidden');};}
function startViewerTimer(){clearInterval(viewerTimer);viewerRem=IFRAME_REFRESH;vrcd.textContent=viewerRem+'s';varc.style.strokeDashoffset=0;viewerTimer=setInterval(()=>{viewerRem--;vrcd.textContent=viewerRem+'s';varc.style.strokeDashoffset=VARC_C*(1-(viewerRem/IFRAME_REFRESH));if(viewerRem<=0){viewerRem=IFRAME_REFRESH;varc.style.strokeDashoffset=0;loadFrame();}},1000);}
function closeViewer(){viewer.classList.remove('open');document.body.style.overflow='';document.getElementById('floatback').classList.remove('visible');clearInterval(viewerTimer);vframe.src='about:blank';currentUrl='';}
function openExternal(){if(currentUrl)window.open(currentUrl,'_blank');}
document.addEventListener('keydown',e=>{if(e.key==='Escape'&&viewer.classList.contains('open'))closeViewer();});
function go(e,name){e.preventDefault();const card=e.currentTarget,url=card.href;sessionStorage.setItem('lo',name);document.getElementById('lc').textContent=name;const r=document.createElement('div');r.className='rpl';const b=card.getBoundingClientRect();r.style.left=(e.clientX-b.left-30)+'px';r.style.top=(e.clientY-b.top-30)+'px';card.appendChild(r);setTimeout(()=>r.remove(),600);setTimeout(()=>openViewer(url,name),200);}

/* â•â• Staggered entrance â•â• */
document.querySelectorAll('.sc-card[href]').forEach((c,i)=>{c.style.opacity='0';c.style.transform='translateY(14px)';c.style.transition=`opacity .4s ease ${i*.07}s,transform .4s ease ${i*.07}s`;setTimeout(()=>{c.style.opacity='1';c.style.transform='none';},80+i*60);});
</script>
</body>
</html>
